<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BTM â€“ SystÃ¨me de Points</title>

  <!-- UI & React -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Import Excel/CSV -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- Export PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    #btm-watermark{
      position:fixed;inset:0;pointer-events:none;display:flex;align-items:center;justify-content:center;z-index:0;
      background-repeat:no-repeat;background-position:center;background-size:contain;
      opacity:var(--wm-opacity,.2);transform:scale(var(--wm-scale,1));filter:saturate(.9)
    }
    #root{position:relative;z-index:1}
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
  <div id="btm-watermark" aria-hidden="true"></div>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const K = {
      P:'btm_participants',
      A:'btm_admin_password',
      L:'btm_logo_dataurl',
      O:'btm_logo_opacity',
      S:'btm_logo_scale',
      N:'btm_new_name'
    };

    if (!localStorage.getItem(K.A)) localStorage.setItem(K.A,'admin123');

    function useWatermark(){
      const [logo,setLogo]=useState(localStorage.getItem(K.L)||'');
      const [opacity,setOpacity]=useState(parseFloat(localStorage.getItem(K.O)||'0.2'));
      const [scale,setScale]=useState(parseFloat(localStorage.getItem(K.S)||'1'));
      useEffect(()=>{
        const wm=document.getElementById('btm-watermark');
        if(wm){
          wm.style.setProperty('--wm-opacity',opacity);
          wm.style.setProperty('--wm-scale',scale);
          wm.style.backgroundImage = logo ? `url('${logo}')` : 'none';
        }
      },[logo,opacity,scale]);
      return {
        logo,opacity,scale,
        saveLogo:(d)=>{setLogo(d);localStorage.setItem(K.L,d)},
        saveOpacity:(v)=>{setOpacity(v);localStorage.setItem(K.O,String(v))},
        saveScale:(v)=>{setScale(v);localStorage.setItem(K.S,String(v))}
      };
    }

    function sortParticipants(list, sortPrimary, sortDir) {
      return [...list].sort((a, b) => {
        if (sortPrimary === 'name') {
          const s = a.name.localeCompare(b.name);
          if (s !== 0) return sortDir === 'asc' ? s : -s;
          if (b.points !== a.points) return b.points - a.points;
          return a.name.localeCompare(b.name);
        } else {
          if (b.points !== a.points)
            return sortDir === 'desc' ? (b.points - a.points) : (a.points - b.points);
          return a.name.localeCompare(b.name);
        }
      });
    }

    function computeRanks(list, sortPrimary = 'points', sortDir = 'desc') {
      const sorted = sortParticipants(list, sortPrimary, sortDir);
      const out = [];
      let lastPts = null, lastRank = 0;
      sorted.forEach((p, i) => {
        const r = (p.points === lastPts) ? lastRank : (i + 1);
        out.push({ ...p, _rank: r });
        lastPts = p.points;
        lastRank = r;
      });
      return out;
    }

    const rankEmoji=(r)=>r===1?'ğŸ¥‡':r===2?'ğŸ¥ˆ':r===3?'ğŸ¥‰':`#${r}`;
    const rankColor=(r)=>r===1?'from-yellow-400 to-yellow-600':r===2?'from-gray-300 to-gray-500':r===3?'from-orange-400 to-orange-600':'from-blue-400 to-blue-600';

    function AddBar({onAdd}){
      const [name,setName]=useState('');
      const inputRef=useRef(null);
      
      const addNow=()=>{ 
        const trimmed=name.trim(); 
        if(!trimmed) return;
        onAdd(trimmed); 
        setName('');
        setTimeout(()=>inputRef.current?.focus(), 50);
      };
      
      return (
        <div className="bg-white rounded-2xl shadow-xl p-5 sm:p-6 mb-4 sm:mb-6">
          <h2 className="text-lg sm:text-xl font-bold text-gray-800 mb-3 sm:mb-4">â• Ajouter un Participant</h2>
          <div className="flex flex-col sm:flex-row gap-3">
            <input 
              ref={inputRef} 
              type="text" 
              value={name}
              onChange={e=>setName(e.target.value)} 
              onKeyDown={e=>{ if(e.key==='Enter') addNow(); }}
              placeholder="Nom du participant"
              className="flex-1 px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" 
            />
            <button onClick={addNow}
              className="bg-blue-600 text-white px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg hover:bg-blue-700 transition font-semibold">
              Ajouter
            </button>
          </div>
        </div>
      );
    }

    function App(){
      const [mode,setMode]=useState(null);
      const [pwd,setPwd]=useState('');
      const [showLogin,setShowLogin]=useState(true);
      const [tab,setTab]=useState('participants');

      const [participants,setParticipants]=useState(()=>{
        const s=localStorage.getItem(K.P); 
        if(!s) return [];
        try{return JSON.parse(s)}catch{return []}
      });

      const [sortPrimary, setSortPrimary] = useState('points');
      const [sortDir, setSortDir] = useState('desc');

      const [sel,setSel]=useState(null);
      const [showAdd,setShowAdd]=useState(false);
      const [lastUpdate,setLastUpdate]=useState(new Date());
      const {logo,opacity,scale,saveLogo,saveOpacity,saveScale}=useWatermark();

      const [showEdit, setShowEdit] = useState(false);
      const [edit, setEdit] = useState({
        id: null, name: '', fast: 0, slow: 0, chal: 0, points: 0
      });
      
      const recomputePoints = (e) => (5 * (e.fast || 0)) + (3 * (e.slow || 0)) + (10 * (e.chal || 0));

      const openEdit = (p) => {
        const draft = {
          id: p.id,
          name: p.name,
          fast: p.fastAnswers || 0,
          slow: p.slowAnswers || 0,
          chal: p.challenges  || 0,
        };
        setEdit({ ...draft, points: recomputePoints(draft) });
        setShowEdit(true);
      };
      
      const saveEdit = () => {
        const name = (edit.name || '').trim();
        const fast = Math.max(0, parseInt(edit.fast, 10) || 0);
        const slow = Math.max(0, parseInt(edit.slow, 10) || 0);
        const chal = Math.max(0, parseInt(edit.chal, 10) || 0);
        const pts  = (5 * fast) + (3 * slow) + (10 * chal);
        if (!name) return alert('Le nom ne peut pas Ãªtre vide.');
        setParticipants(ps =>
          ps.map(x => x.id === edit.id
            ? { ...x, name, fastAnswers: fast, slowAnswers: slow, challenges: chal, points: pts }
            : x
          )
        );
        setShowEdit(false);
      };

      useEffect(()=>{
        try{ localStorage.setItem(K.P, JSON.stringify(participants)); }catch(e){}
        setLastUpdate(new Date());
      },[participants]);

      useEffect(()=>{
        if(mode!=='participant') return;
        const iv=setInterval(()=>{
          const s=localStorage.getItem(K.P);
          if(s){ try{ setParticipants(JSON.parse(s)); setLastUpdate(new Date()); }catch(e){} }
        },10000);
        return ()=>clearInterval(iv);
      },[mode]);

      const login=(as)=>{
        if(as==='admin'){
          const a=localStorage.getItem(K.A)||'admin123';
          if(pwd===a){ setMode('admin'); setShowLogin(false); setPwd(''); }
          else alert('âŒ Mot de passe incorrect !');
        } else {
          setMode('participant'); setShowLogin(false);
        }
      };
      
      const logout=()=>{ setMode(null); setShowLogin(true); setPwd(''); };

      const addParticipant=(name)=>{
        setParticipants(p=>[...p,{
          id:Date.now()+Math.floor(Math.random()*1e5),
          name,points:0,fastAnswers:0,slowAnswers:0,challenges:0
        }]);
      };
      
      const del=(id)=>{ 
        if(confirm('Supprimer ce participant ?')) 
          setParticipants(participants.filter(p=>p.id!==id)); 
      };
      
      const addPts=(id,t)=>{
        setParticipants(ps=>ps.map(p=>{
          if(p.id!==id) return p;
          if(t==='fast') return {...p,points:p.points+5,fastAnswers:p.fastAnswers+1};
          if(t==='slow') return {...p,points:p.points+3,slowAnswers:p.slowAnswers+1};
          if(t==='challenge') return {...p,points:p.points+10,challenges:p.challenges+1};
          return p;
        }));
        setShowAdd(false); setSel(null);
      };

      const reset=()=>{
        if(confirm('âš ï¸ Supprimer toutes les donnÃ©es ? Action irrÃ©versible !')){
          setParticipants([]);
          localStorage.removeItem(K.P);
          alert('âœ… DonnÃ©es supprimÃ©es.');
        }
      };

      const copyClip=()=>{
        const rows=computeRanks(participants, sortPrimary, sortDir)
          .map(p=>`${p._rank}\t${p.name}\t${p.points}\t${p.fastAnswers}\t${p.slowAnswers}\t${p.challenges}`);
        const text=['Rang\tNom\tPoints Total\tRÃ©ponses Rapides (5pts)\tRÃ©ponses Tardives (3pts)\tDÃ©fis Pratiques (10pts)',...rows].join('\n');
        navigator.clipboard.writeText(text).then(()=>alert('âœ… DonnÃ©es copiÃ©es !')).catch(()=>alert('âŒ Erreur lors de la copie.'));
      };
      
      const exportCSV=()=>{
        const BOM = '\uFEFF';
        const headers=['Rang','Nom','Points Total','RÃ©ponses Rapides (5pts)','RÃ©ponses Tardives (3pts)','DÃ©fis Pratiques (10pts)'];
        const rows=computeRanks(participants, sortPrimary, sortDir)
          .map(p=>[p._rank,`"${p.name}"`,p.points,p.fastAnswers,p.slowAnswers,p.challenges]);
        const csv=BOM+[headers,...rows].map(r=>r.join(';')).join('\n');
        const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); 
        a.href=url; 
        a.download=`classement_btm_${new Date().toLocaleDateString('fr-FR')}.csv`; 
        a.click();
        URL.revokeObjectURL(url);
      };
      
      const exportPDF = async () => {
        try {
          const node = document.getElementById('btm-report');
          if (!node) return alert('Section Ã  exporter introuvable.');

          const canvas = await html2canvas(node, {
            scale: 2,
            useCORS: true
          });

          const imgData = canvas.toDataURL('image/png');
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');

          const pageWidth = pdf.internal.pageSize.getWidth();
          const pageHeight = pdf.internal.pageSize.getHeight();
          const imgWidth = pageWidth;
          const imgHeight = (canvas.height * imgWidth) / canvas.width;

          if (imgHeight <= pageHeight) {
            pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
          } else {
            let heightLeft = imgHeight;
            let position = 0;

            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft > 0) {
              position = heightLeft - imgHeight;
              pdf.addPage();
              pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
              heightLeft -= pageHeight;
            }
          }

          pdf.save(`classement_btm_${new Date().toLocaleDateString('fr-FR')}.pdf`);
        } catch (e) {
          console.error(e);
          alert('âŒ Ã‰chec de gÃ©nÃ©ration du PDF.');
        }
      };

      const handleCSVText = (text) => {
        const lines = text.split(/\r?\n/).filter(Boolean);
        if (!lines.length) return;
        const head = lines[0].split(/;|,|\t/).map(h => h.trim());
        const rows = lines.slice(1).map(l => {
          const c = l.split(/;|,|\t/);
          const o = {};
          head.forEach((h,i)=> o[h] = (c[i]||'').trim());
          return o;
        });
        upsert(rows);
      };

      const upsert = (rows) => {
        const by = new Map(participants.map(p => [p.name.toLowerCase(), p]));
        const norm = (v, d=0) => isNaN(parseInt(v)) ? d : parseInt(v);

        rows.forEach(r => {
          const name = (r.name || r.Nom || r.Participant || '').toString().trim();
          if (!name) return;
          const ex = by.get(name.toLowerCase());
          const obj = {
            id: ex ? ex.id : Date.now() + Math.floor(Math.random()*1e5),
            name,
            points:      norm(r.points ?? r.Points ?? r['Points Total'], ex ? ex.points : 0),
            fastAnswers: norm(r.fastAnswers ?? r.Rapides ?? r['RÃ©ponses Rapides (5pts)'], ex ? ex.fastAnswers : 0),
            slowAnswers: norm(r.slowAnswers ?? r.Tardives ?? r['RÃ©ponses Tardives (3pts)'], ex ? ex.slowAnswers : 0),
            challenges:  norm(r.challenges ?? r['DÃ©fis'] ?? r['DÃ©fis Pratiques (10pts)'], ex ? ex.challenges : 0),
          };
          by.set(name.toLowerCase(), obj);
        });

        setParticipants([...by.values()]);
        alert('âœ… Import terminÃ©.');
      };

      const importFile = async (file) => {
        if (!file) return;
        const ext = file.name.toLowerCase().split('.').pop();
        const buf = await file.arrayBuffer();
        if (ext === 'csv' || ext === 'txt') {
          const text = new TextDecoder('utf-8').decode(new Uint8Array(buf));
          handleCSVText(text);
        } else if (ext === 'xlsx' || ext === 'xls') {
          const wb = XLSX.read(buf, { type: 'array' });
          const sh = wb.Sheets[wb.SheetNames[0]];
          const json = XLSX.utils.sheet_to_json(sh, { defval:'' });
          upsert(json);
        } else {
          alert('Format non supportÃ©. Utilisez CSV/XLSX.');
        }
      };

      const importGSheet = async () => {
        const url = prompt("Collez l'URL CSV public de Google Sheets :");
        if (!url) return;
        try {
          const res = await fetch(url);
          if (!res.ok) throw new Error('HTTP ' + res.status);
          const text = await res.text();
          handleCSVText(text);
        } catch (e) {
          alert('âŒ Ã‰chec CSV. Publiez la feuille en CSV et rendez-la publique.');
        }
      };

      const bulkAddNames = (raw) => {
        const names = raw.split(/\r?\n|,|;|\t/).map(s => s.trim()).filter(Boolean);
        if (!names.length) return alert('Liste vide.');
        setParticipants(prev => ([
          ...prev,
          ...names.map(name => ({
            id: Date.now() + Math.floor(Math.random()*1e5),
            name,
            points: 0, fastAnswers: 0, slowAnswers: 0, challenges: 0
          }))
        ]));
        alert(`âœ… ${names.length} participant(s) ajoutÃ©(s).`);
      };

      const HeaderLegend=({right})=>(
        <div className="bg-white rounded-3xl shadow-xl p-4 sm:p-6 mb-4 sm:mb-6">
          <div className="flex items-center justify-between flex-wrap gap-3 sm:gap-4">
            <div className="flex items-center gap-3 sm:gap-4">
              <div className="text-yellow-500 text-3xl sm:text-4xl">ğŸ†</div>
              <div>
                <h1 className="text-2xl sm:text-3xl font-bold text-gray-800">
                  {mode==='admin'?'ğŸ”§ Mode Administrateur':'ğŸ‘¥ Mode Participant'}
                </h1>
                <p className="text-gray-600 text-sm sm:text-base">Formation BTM - BiT Technologie</p>
                {mode==='participant'&&(
                  <p className="text-xs sm:text-sm text-blue-600 mt-1">
                    Actualisation auto 10s â€” derniÃ¨re : {lastUpdate.toLocaleTimeString('fr-FR')}
                  </p>
                )}
              </div>
            </div>
            <div className="flex gap-2 flex-wrap">{right}</div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4 mt-4 sm:mt-6">
            <div className="flex items-center gap-3 bg-blue-50 p-3 sm:p-4 rounded-lg">
              <span className="text-blue-600 text-xl">â±ï¸</span>
              <div>
                <div className="font-bold text-blue-800">5 points</div>
                <div className="text-sm text-gray-600">RÃ©ponse rapide (&lt;30min)</div>
              </div>
            </div>
            <div className="flex items-center gap-3 bg-green-50 p-3 sm:p-4 rounded-lg">
              <span className="text-green-600 text-xl">âœ”ï¸</span>
              <div>
                <div className="font-bold text-green-800">3 points</div>
                <div className="text-sm text-gray-600">RÃ©ponse tardive</div>
              </div>
            </div>
            <div className="flex items-center gap-3 bg-purple-50 p-3 sm:p-4 rounded-lg">
              <span className="text-purple-600 text-xl">ğŸ¬</span>
              <div>
                <div className="font-bold text-purple-800">10 points</div>
                <div className="text-sm text-gray-600">DÃ©fi pratique rÃ©ussi</div>
              </div>
            </div>
          </div>
        </div>
      );

      const SortButtons = () => (
        <div className="flex items-center gap-2 bg-gray-100 rounded-lg p-1">
          <button
            className={`px-3 py-2 rounded text-sm ${sortPrimary==='points' ? 'bg-white font-semibold' : ''}`}
            onClick={() => { setSortPrimary('points'); setSortDir('desc'); }}
          >Points â†“</button>
          <button
            className={`px-3 py-2 rounded text-sm ${sortPrimary==='name' ? 'bg-white font-semibold' : ''}`}
            onClick={() => { setSortPrimary('name'); setSortDir('asc'); }}
          >Nom â†‘</button>
        </div>
      );

      const headerRightParticipant=(<>
        <SortButtons />
        <button onClick={()=>{
          const s=localStorage.getItem(K.P);
          if(s){ try{ setParticipants(JSON.parse(s)); setLastUpdate(new Date()); alert('âœ… ActualisÃ© !'); }catch(e){} }
        }} className="bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm">
          ğŸ”„
        </button>
        <button onClick={logout}
          className="bg-gray-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-gray-700 transition text-sm">
          ğŸšª
        </button>
      </>);

      const headerRightAdmin=(<>
        <SortButtons />
        <button onClick={()=>setTab('participants')}
          className={`px-3 py-2 rounded-lg text-sm ${tab==='participants'?'bg-blue-600 text-white':'bg-gray-100'}`}>
          ğŸ“Š
        </button>
        <button onClick={()=>setTab('import')}
          className={`px-3 py-2 rounded-lg text-sm ${tab==='import'?'bg-blue-600 text-white':'bg-gray-100'}`}>
          ğŸ“¥
        </button>
        <button onClick={()=>setTab('settings')}
          className={`px-3 py-2 rounded-lg text-sm ${tab==='settings'?'bg-blue-600 text-white':'bg-gray-100'}`}>
          âš™ï¸
        </button>
        <button onClick={copyClip}
          className="bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition text-sm">ğŸ“‹</button>
        <button onClick={exportCSV}
          className="bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition text-sm">CSV</button>
        <button onClick={exportPDF}
          className="bg-emerald-600 text-white px-3 py-2 rounded-lg hover:bg-emerald-700 transition text-sm">PDF</button>
        <button onClick={reset}
          className="bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition text-sm">ğŸ—‘ï¸</button>
        <button onClick={logout}
          className="bg-gray-600 text-white px-3 py-2 rounded-lg hover:bg-gray-700 transition text-sm">ğŸšª</button>
      </>);

      const ranked=computeRanks(participants, sortPrimary, sortDir);
      const podGroups=[1,2,3].map(r=>ranked.filter(p=>p._rank===r));

      function LeaderboardBlocks({readonly}){
        return (<>
          {!readonly && <AddBar onAdd={addParticipant} />}

          {ranked.length>0 && (
            <div className="bg-white rounded-2xl shadow-xl p-5 sm:p-6 mb-4 sm:mb-6">
              <h2 className="text-lg sm:text-xl font-bold text-gray-800 mb-3 sm:mb-4">ğŸ† Podium</h2>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4">
                {[1,2,3].map((r,idx)=>(
                  <div key={r} className={`p-4 rounded-xl ${
                    r===1?'bg-yellow-50 border-2 border-yellow-300':
                    r===2?'bg-gray-50 border-2 border-gray-300':
                           'bg-orange-50 border-2 border-orange-300'
                  }`}>
                    <div className="text-2xl mb-2">{rankEmoji(r)}</div>
                    {podGroups[idx].length===0?(
                      <div className="text-gray-500">â€”</div>
                    ):podGroups[idx].map(p=>(
                      <div key={p.id} className="flex items-center justify-between py-1">
                        <div className="font-semibold text-gray-800">{p.name}</div>
                        <div className="text-gray-900 font-bold">{p.points} pts</div>
                      </div>
                    ))}
                  </div>
                ))}
              </div>
            </div>
          )}

          <div className="bg-white rounded-2xl shadow-xl overflow-hidden mb-4 sm:mb-6">
            <div className="p-4 sm:p-6 bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
              <h2 className="text-xl sm:text-2xl font-bold">ğŸ“ˆ Classement Complet</h2>
            </div>

            {ranked.length===0?(
              <div className="p-10 sm:p-12 text-center text-gray-500">
                <div className="text-5xl sm:text-6xl mb-2 opacity-30">ğŸ†</div>
                <p className="text-lg sm:text-xl">Aucun participant</p>
              </div>
            ):(
              <div className="overflow-x-auto">
                <table className="w-full text-sm sm:text-base">
                  <thead className="bg-gray-100 text-left">
                    <tr>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 font-bold text-gray-700">Rang</th>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 font-bold text-gray-700">Participant</th>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 text-center font-bold text-gray-700">Points</th>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 text-center font-bold text-gray-700">Rapides</th>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 text-center font-bold text-gray-700">Tardives</th>
                      <th className="px-4 sm:px-6 py-3 sm:py-4 text-center font-bold text-gray-700">DÃ©fis</th>
                      {!readonly&&<th className="px-4 sm:px-6 py-3 sm:py-4 text-center font-bold text-gray-700">Actions</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {ranked.map(p=>(
                      <tr key={p.id} className={`border-t hover:bg-gray-50 ${p._rank<=3?'bg-yellow-50':''}`}>
                        <td className="px-4 sm:px-6 py-3 sm:py-4">
                          <span className="text-xl sm:text-2xl font-bold">{rankEmoji(p._rank)}</span>
                        </td>
                        <td className="px-4 sm:px-6 py-3 sm:py-4">
                          <span className="font-semibold text-gray-800">{p.name}</span>
                        </td>
                        <td className="px-4 sm:px-6 py-3 sm:py-4 text-center">
                          <span className={`inline-block px-3 sm:px-4 py-1.5 sm:py-2 rounded-full font-bold text-white bg-gradient-to-r ${rankColor(p._rank)}`
